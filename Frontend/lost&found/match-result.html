<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Match Results</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f2f2f2; padding: 40px; }
    h2 { color: #2b80ff; }
    .match-box {
      background: #fff;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .label { font-weight: bold; }
    img {
      width: 100%;
      max-height: 200px;
      object-fit: cover;
      border-radius: 6px;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <h2 id="main-title">Match Result</h2>
  <div id="bestMatch" class="match-box"></div>

  <h2 id="other-title">Other Items</h2>
  <div id="otherMatches"></div>

  <script>
    const mode = localStorage.getItem("found_matches") ? "found" : "lost";
    const matches = JSON.parse(localStorage.getItem(`${mode}_matches`)) || [];
    const userItem = JSON.parse(localStorage.getItem("userItem")) || {};

    // Sample fallback list for demonstration (should come from DB if needed)
    const allItems = mode === "lost" ? [] : []; // Not needed if already loaded on the backend side

    function createMatchCard(item) {
    const div = document.createElement("div");
    div.className = "match-box";

    // Fix the image path
    const imageUrl = item.image?.startsWith('/uploads/')
    ?  `http://localhost:5000${item.image}`
     : item.image;

    div.innerHTML = `
      ${imageUrl ? `<img src="${imageUrl}" alt="Item Image">` : ''}
      <div><span class="label">Item:</span> ${item.name}</div>
      <div><span class="label">Description:</span> ${item.description}</div>
      <div><span class="label">Phone:</span> ${item.phone}</div>
    `;
   return div;
  }


    const bestMatchContainer = document.getElementById("bestMatch");
    const otherMatchesContainer = document.getElementById("otherMatches");
    const mainTitle = document.getElementById("main-title");
    const otherTitle = document.getElementById("other-title");

    if (mode === "lost") {
      mainTitle.textContent = "Best Match from Found Items";
      otherTitle.textContent = "Other Found Items";
    } else {
      mainTitle.textContent = "Best Match from Lost Items";
      otherTitle.textContent = "Other Lost Items";
    }

    const best = matches[0];
    const rest = matches.slice(1);

    if (best) bestMatchContainer.appendChild(createMatchCard(best));
    else bestMatchContainer.innerHTML = "<p>No matches found.</p>";

    if (rest.length > 0) {
      rest.forEach(item => {
        otherMatchesContainer.appendChild(createMatchCard(item));
      });
    } else {
      otherMatchesContainer.innerHTML = "<p>No other items available.</p>";
    }
  </script>
</body>
</html>
